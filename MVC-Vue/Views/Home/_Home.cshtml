@using Core.Application.DTOs
@using MVC_Vue.Controllers
@using MVC_Vue.Databases
@model HomeDto

<div class="modern-container">
    @foreach (var category in Model.Categories)
    {
        <div class="section-title">@category.Name</div>
       <v-row>
        @foreach (var item in category.Products)
        {
            var finalPrice = item.Price;
            <v-col cols="12" xs="6" sm="6" md="6" lg="4">
                <v-card class="mx-auto" max-width="344" 
                    href="/products/@item.Slug" key="@item.Id"
                    flat>
                    @if(item.Discount > 0)
                    {
                        <div class="discount-badge">-@item.Discount%</div>
                    }
                    <img
                        src="@item.Images.First().Url"
                        height="500px"
                        cover
                    ></img>
                    <v-card-title class="text-h6">@item.Name</v-card-title>
                    <v-card-subtitle>
                        <div>

                            @if(item.Discount > 0) 
                            {
                                finalPrice = item.Price * (1 - (decimal)item.Discount / 100);
                                <span class="sale-off-price">
                                    {{ $formatCurrency(@item.Price) }}
                                </span>
                            }
                            <span class="main-price">
                                {{ $formatCurrency(@finalPrice) }}
                            </span>
                        </div>
                    </v-card-subtitle>
                <v-card-actions>
                    <v-btn
                        color="#13547A"
                        variant="text"
                        href="/products/@item.Slug"
                    >
                        Chi tiết
                    </v-btn>
                    <v-spacer></v-spacer>
                    <v-btn
                        variant="outlined"
                        class="btn-main"
                        v-on:click="addToCart(@item)"
                    >
                        Mua
                    </v-btn>
                    </v-card-actions>
                </v-card>
            </v-col>
        }
    </v-row>
    }
</div>

    
